{% extends 'portal/portal_base_sidebar.html'%}

{% load notifications_tags %} 

{% load static %}

{% block title %} Portal | Notifications Center {% endblock title %}

{% block css %}

  {{ block.super }}

  <link rel="stylesheet" href="{% static 'stock/style.css' %}" type="text/css">
{% endblock css %}

{% block portal_content %}
  <div class="portal-content-title">
    <h1>Notifications</h1>
  </div>
  <div class="portal-top-bar notification-bar">
    <p>{% notifications_unread %} Notification{{notifications_unread|pluralize}}</p>
    {% if notifications_unread %}
      <p>
        <a class="btn-black" href="{% url 'portal:notice-read-all' %}">Clear all</a>
      </p>
    {% endif %}
  </div>
  <div class="portal-content-body notification-content">
    <div class="notifications-list">
      
      {% if notifications_unread %}

        {% for notice in notifications_unread %}     
            <div class="alert alert-block bg-notice">
              <div class="notice-icon">
                <div class="img-wrapper">
                
                  {% if notice.action_object_content_type.model == 'message' %}
                    <img src="{% static 'portal/img/message-black.svg' %}">
                  {% elif notice.action_object_content_type.model == 'event' %}
                    <img src="{% static 'portal/img/event-black.svg' %}">
                  {% elif notice.action_object_content_type.model == 'task' %}
                    <img src="{% static 'portal/img/task-black.svg' %}">
                  {% elif notice.action_object_content_type.model == 'post' %}
                    <img src="{% static 'portal/img/post-black.svg' %}">
                  {% endif %}

                </div>
              </div>
              <div class="notice-content">
                <a class="close pull-right" href="{% url 'portal:notice-read' notice.id %}">
                  <span class="material-icons text-red">close</span>
                </a>
                <p class="notice-text">
                  <a href={% url 'user-detail' notice.actor.slug %}>{{ notice.actor }}</a>

                  {{ notice.verb }}

                  {% if notice.target %}
                      of {{ notice.target }}
                  {% endif %}
                </p>
                <p class="notice-text">
                  {% if notice.action_object_content_type.model == 'message' %}               
                    <a class="" href="{% url 'message:inbox-detail' notice.action_object.id %}">
                  {% elif notice.action_object_content_type.model == 'event' %}
                    <a class="" href="{% url 'project:event-detail' notice.action_object.slug %}">
                  {% elif notice.action_object_content_type.model == 'task' %}
                    <a class="" href="{% url 'project:task-detail' notice.action_object.slug %}">
                  {% elif notice.action_object_content_type.model == 'post' %}
                    <a class="" href="{% url 'blog:post-detail' notice.action_object.slug %}">
                  {% endif %}

                  {{ notice.action_object}}
                  

                  </a>
                </p>
                <p class="notice-timesince">{{ notice.timesince }} ago</p>
                <p>{{ notice.description|linebreaksbr }}</p>
                <div class="notice-actions">

                  {% for action in notice.data.actions %}
                      <a class="btn" href="{{ action.href }}">{{ action.title }}</a>
                  {% endfor %}

                </div>
              </div>
            </div>
        {% endfor %}

      {% comment %} {% else %}
        <div class="py-3 px-3">
          <p>No  notifications</p>
        </div> {% endcomment %}
      {% endif%}
      
    </div>
  </div>
  {% endblock portal_content %}